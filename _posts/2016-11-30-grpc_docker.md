---
tags: go
layout: post
title: 关于服务微型化实践过程中的一点思考
category: Language
---

首先是实现所采用的技术思想，核心是rpc+container，意思就是说各个服务都部署在容器里，
<!--more-->彼此通过RPC来沟通。这种方式的好处源于容器之间独立性，和scale的能力，对付常见的互联网大流量的冲击，也容易应付。弊端主要是源于沟通成本，RPC调用不比本地访问，对网络的依赖，对信息流的编码解码，可能都会损失掉一部分性能。

在说说具体对应的技术框架，GRPC+ProtoBuffer+Docker,GRPC是谷歌开源出来的一个RPC框架，好处就是跨语言，对各种主流语言均有对应支持。ProtoBuffer是一个序列化工具，也是谷歌GRPC默认所采用的，我们知道，网络间通信的数据必须序列化，而protoBuffer把这些需要通信的数据，定义在一个*.proto格式的文件里，之后，通过一个protoc的编译工具，可以生成对应语言的方法，比如Golang就是*.pb.go,最后我们所需要作的，便是根据业务，实现那个方法即可。这个*.proto定义文件，是同时支持rpcAPI和restAPI的，也就是说我们定义的方法，既可以供程序调用，也可以让客户直接http方式访问的。这在当前手机与电脑均成为主流客户端的情况下，是非常有利的。

再说说麻烦与问题，比如我们采用Golang实现微服务，其实go语言本身是自带rpc支持的，用了GRPC,尤其是protobuffer，我们必须多一个环节：专门去描述这些接口。而且我们会发现，proto的服务描述能力，是比较有限的，主要就是一些string,int,bool及其组合，这和直接传递对象，差别是很大的。比如我们想把一个数据库对象直接传递过去,我们必须在proto文件里重新定义一遍，而且有些对象，比如复杂类型，必须拆分，从技术上，这是很没必要的。相反，如果用官方gob，就会减少很多类似问题。跨语言的优势，其实大部分情况下，我们用不着。至于GRPC的性能，是基于http2.0，这个就得靠大数据量的情况下来验证了。


